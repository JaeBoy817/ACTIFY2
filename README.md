# ACTIFY

ACTIFY is a production-ready SaaS web app for SNF, Memory Care, and ALF Activity Directors.

Headline in product: **"Documentation that doesn't feel like paperwork."**

## Stack

- Next.js 14 App Router + TypeScript
- TailwindCSS + shadcn-style UI components
- Prisma ORM with SQLite default (`DATABASE_URL=file:./dev.db`)
- Clerk auth (`@clerk/nextjs`)
- Zod validation
- Server Actions for mutations, Route Handlers for exports
- Recharts for analytics charts

## Features Implemented

### Marketing
- `/` landing
- `/pricing`
- `/docs`

### Auth + App Shell
- Clerk `ClerkProvider`, sign-in and sign-up routes
- `middleware.ts` protecting `/app` routes
- First-login bootstrap creates `Facility` and `User` records
- App layout with sidebar navigation + top bar + `UserButton`

### Access + Settings
- ACTIFY is free for all users
- `/app/settings` for facility and module visibility settings

### Core Workflow
- `/app/templates`: template CRUD + duplicate + one-click schedule
- `/app/calendar`: calendar builder, adaptation toggles, checklists
- `/app/calendar/[id]/attendance`: attendance capture + barriers
- `/app/notes/new`: progress note builder with templates, quick phrase chips, rule-based narrative generation, goal linking
- `/app/reports`: monthly report download (CSV + PDF)

### Full Toolkit
- `/app/residents` + `/app/residents/[id]`: profile, goals, assessments, timeline, attendance evidence
- `/app/analytics`: heatmap, top barriers, engagement trend
- `/app/volunteers`: scheduling + sign-in/out log
- `/app/inventory`: stock + reorder alerts + transactions
- `/app/prize-cart`: ledger, revenue, fastest sellers, restock suggestions
- `/app/resident-council`: meetings + concern tracker
- `/app/settings`: facility profile + module visibility controls

### Printables
- `/app/print/daily?date=YYYY-MM-DD`
- `/app/print/weekly?weekStart=YYYY-MM-DD`
- `/app/print/unit/[unitId]?weekStart=YYYY-MM-DD`
- `/app/print/resident/[residentId]?date=YYYY-MM-DD`

### Data + Ops
- Full Prisma schema with facility-scoped relations and indexes
- Audit logging for major entities
- Module visibility/mode flags per facility (Core Workflow vs Full Toolkit)
- Seed script creates sample units, residents, templates, note templates, and sample operational data

## Environment

Copy `.env.example` to `.env` and fill values:

```bash
cp .env.example .env
```

Required keys:

- `DATABASE_URL="file:./dev.db"`
- `NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY`
- `CLERK_SECRET_KEY`
- `NEXT_PUBLIC_CLERK_SIGN_IN_URL=/sign-in`
- `NEXT_PUBLIC_CLERK_SIGN_UP_URL=/sign-up`
- `NEXT_PUBLIC_APP_URL=http://localhost:3000`

## Setup

```bash
npm install
npx prisma generate
```

### Apply schema locally

```bash
npx prisma db push
```

Then seed data:

```bash
npm run prisma:seed
```

## Run

```bash
npm run dev
```

## Clerk Notes

- Add valid Clerk keys to `.env`.
- With valid keys, `/sign-in` and `/sign-up` are fully active.
- First authenticated app visit auto-provisions user/facility records in DB.

## Role Model

- `ADMIN`: full access, role management, audit log
- `AD`: full operations except role changes
- `ASSISTANT`: operational create/edit, no monthly export
- `READ_ONLY`: view only

Enforced in server actions and route handlers.

## Project Structure

- `app/(marketing)` public pages
- `app/app` authenticated app routes
- `app/api` API route handlers
- `components` UI and app components
- `lib` auth, permissions, Prisma, reports, utilities
- `lib/report-pdf` monthly PDF theme, glass components, transforms, and generator
- `prisma` schema, migrations, seed

## Monthly PDF Theme Tweaks

The monthly PDF export is generated by `generateReportPdf(...)` in `lib/report-pdf/monthly-report.tsx`.

- Theme tokens live in `lib/report-pdf/ReportTheme.ts`
- Data mapping lives in `lib/report-pdf/transform.ts`
- Route handler uses those pieces in `app/app/reports/pdf/route.tsx`
- The reports page is download-only (no embedded PDF preview)

Quick changes:
- Adjust colors, spacing, and typography in `defaultReportTheme`.
- Update page layout/content composition in `lib/report-pdf/monthly-report.tsx`.
- Optional Gotham font override env vars:
  - `ACTIFY_PDF_DISPLAY_FONT=/absolute/path/to/Gotham-Black.otf`
  - `ACTIFY_PDF_BODY_FONT=/absolute/path/to/GothamBook.ttf`
  - If these are unset, PDF uses stable built-in Helvetica fonts.

## Verification Run (performed)

- `npm install` passed
- `npm run lint` passed
- `npm run build` passed
# ACTIFY2
